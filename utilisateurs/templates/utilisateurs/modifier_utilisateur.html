{% extends "base_pro.html" %}
{% load widget_tweaks %}

{% block title %}Modifier {{ user_a_modifier.username }}{% endblock %}

{% block content %}
<div class="py-4">
    <h1 class="display-5 fw-bold text-dark mb-4">
        Modification Utilisateur : {{ user_a_modifier.username }}
    </h1>

    <div class="card shadow-lg">
        <div class="card-body">
            <form method="POST">
                {% csrf_token %}

                <h4 class="mb-3 text-primary">Informations de Contact</h4>
                
                <div class="row">
                    {% for field in form %}
                        {% if field.name != 'username' %} <div class="col-md-6 mb-3">
                                <label for="{{ field.id_for_label }}" class="form-label fw-bold">{{ field.label }}</label>
                                {{ field|add_class:"form-control" }}
                                {% for error in field.errors %}<div class="text-danger small">{{ error }}</div>{% endfor %}
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
                
                <hr class="my-4">

                <h4 class="mb-3 text-danger">Statuts & Rôles</h4>
                
                <div class="mb-3">
                    <label for="id_role" class="form-label fw-bold">Rôle Personnalisé</label>
                    <select class="form-select" id="id_role" name="role">
                        {% for value, label in user_a_modifier.ROLE_CHOICES %}
                            <option value="{{ value }}" {% if user_a_modifier.role == value %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                    <small class="d-block text-muted">Ceci détermine la catégorie d'utilisateur (Admin, Client, Livreur).</small>
                </div>

                <div class="mb-3 form-check form-switch">
                    <input class="form-check-input" type="checkbox" id="isStaffSwitch" name="is_staff" 
                           {% if user_a_modifier.is_staff %}checked{% endif %}>
                    <label class="form-check-label fw-bold" for="isStaffSwitch">
                        Est Staff (Accès à l'Espace Pro)
                    </label>
                </div>

                <div class="mb-4 form-check form-switch">
                    <input class="form-check-input" type="checkbox" id="isSuperuserSwitch" name="is_superuser" 
                           {% if user_a_modifier.is_superuser %}checked{% endif %}>
                    <label class="form-check-label fw-bold text-danger" for="isSuperuserSwitch">
                        Est Superuser (Accès Admin Total)
                    </label>
                </div>
                
                <hr>

                <div class="d-flex justify-content-between">
                    <a href="{% url 'tableau_bord_utilisateurs' %}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Retour
                    </a>
                    <button type="submit" class="btn btn-success shadow-sm">
                        <i class="fas fa-save"></i> Enregistrer les Modifications
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock content %}